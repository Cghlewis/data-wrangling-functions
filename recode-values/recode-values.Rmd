---
title: "Recode values"
output: 
  html_document:
    toc: false
    anchor_sections: FALSE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(comment = NA,
                      message = FALSE,
                      warning = FALSE)
```

<br>

### Package: dplyr

---

#### Function: `recode()`

---

**Note:** The `dplyr::recode()` formula is: old value=new value, this is opposite of `dplyr::rename()`

<br>

**1\. Recode character values into different character values (for gender)**

Review the data (d4)

```{r, echo=FALSE}

source("data.R")
d4

```

Recode gender

* Note: Parentheses are required around the new value when recoding into a character variable.

* Note: We are recoding back into the same variable using `dplyr::mutate()`. However, we could have recoded into a new variable by changing the name of *gender*.

```{r}

d4 %>% dplyr::mutate(gender=dplyr::recode(gender, m="male", f="female", n="nonbinary"))

```


**2\. Recode a character variable (gender) into a numeric variable**

Review the data (d4)

```{r, echo=FALSE}

source("data.R")
d4

```

Recode gender

* Note: We are recoding back into the same variable using `dplyr::mutate()`. However, we could have recoded into a new variable by changing the name of *gender*.

```{r}

d4 %>% dplyr::mutate(gender=dplyr::recode(gender, m=1, f=2, n=3))

```


**3\. Recode just one value in a variable (Var2)**

Review the data (d5)

```{r, echo=FALSE}

source("data.R")
d5

```

Recode `16` to `4` in Var2

* Note:  The `dplyr::recode()` function considers the old value as a *name* and therefore, in order to use a number as a name or a character value, you have to surround it with backticks

```{r}

d5 %>% dplyr::mutate(Var2=dplyr::recode(Var2, `16`=4))

```


---

#### Function: `recode_factor()`

---

**Note:** The `dplyr::recode_factor()` formula is: old value=new value, this is opposite of `dplyr::rename()`

<br>

**1\. Recode a character variable (lunch) into a factor**

Review the data (d4)

```{r, echo=FALSE}

source("data.R")
d4

```

Recode lunch status

* Note: `dplyr::recode_factor` will only recode factor or character variables. If your variable is numeric, you will need to convert it to character or factor before using recode factor. If your variable is character, `dplyr::recode_factor` will convert your variable to factor **and** recode it.

* Note: Parentheses are required around new value when recoding into a character/factor variable.

* Note: We are recoding back into the same variable using `dplyr::mutate()`. However, we could have recoded into a new variable by changing the name of *lunch*.

```{r}

d4 <- d4 %>% dplyr::mutate(lunch=dplyr::recode_factor(lunch, p="paid", r="reduced", f="free"))

d4

```

Review the factor levels

```{r}

levels(d4$lunch)

```

**2\. Recode a numeric variable (lunch) into a factor**

Review the data (d7)

```{r, echo=FALSE}

source("data.R")
d7

```

Recode lunch status

* Note: The function `dplyr::recode_factor` will convert your variable to factor **and** recode it.

* Note: `dplyr::recode_factor` will only recode factor or character variables. If your variable is numeric, you will need to add parentheses around your numeric old values. 

* Note: Parentheses are required around new value when recoding into a character/factor variable.

* Note: We are recoding back into the same variable using `dplyr::mutate()`. However, we could have recoded into a new variable by changing the name of *lunch*.

```{r}

d7 <- d7 %>% dplyr::mutate(lunch=dplyr::recode_factor(
  lunch, "1"="paid", "2"="reduced", "3"="free"))

d7

```

Review the factor levels

```{r}

levels(d7$lunch)

```


### Package: forcats

---

#### Function: `fct_recode()`

---

**Note:** The `forcats::fct_recode()` formula is: new value=old value, this is opposite of `dplyr::recode()` but the same as `dplyr::rename()`

<br>

**1\. Recode a numeric variable (lunch) into a factor**

Review the data (d7)

```{r, echo=FALSE}

source("data.R")
d7

```

Recode lunch status

* Note: `forcats::fct_recode` will only recode factor or character variables. If your variable is numeric, you will need to convert it to character or factor before using recode factor. If your variable is character, `forcats::fct_recode` will convert your variable to factor **and** recode it. As you see below, I converted our numeric variable to character in order to use the function.

* Note: We are recoding back into the same variable using `dplyr::mutate()`. However, we could have recoded into a new variable by changing the name of *lunch*.

```{r}

d7 <- d7 %>% dplyr::mutate(lunch=forcats::fct_recode(as.character(lunch), paid="1", reduced="2", free="3"))

d7

```

Review the factor levels

```{r}

levels(d7$lunch)

```
