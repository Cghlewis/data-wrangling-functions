---
title: "Add value labels"
output:
  html_document:
    anchor_sections: FALSE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(comment = NA,
                      message = FALSE,
                      warning = FALSE)
```

<br>

### Package: labelled

---

#### Function: `set_value_labels()`

---

**1\. Add value labels for one or more variables (Var2 and Var3)**

Review the data (d3)

```{r, echo=FALSE}

source("data.R")
d3

```

Add value labels to Var2 and Var3

* Note: Parentheses are *not* required around labels here but I am using them around multi-word labels with spaces. Also using them around all labels will not hurt anything.

```{r}

d3 <- d3 %>% labelled::set_value_labels(
  Var2= c("not interested"=1, "mildly interested"=2,"very interested"=3),
                                      Var3=c(none=1, "reduced-price"=2, free=3))

labelled::val_labels(d3)

```

**2\. Create labels, then add labels to variables (Var2 and Var3)**

Review the data (d3)

```{r, echo=FALSE}

source("data.R")
d3

```

Create labels

* Note: Parentheses are *not* required around labels here, although adding them will not hurt.

```{r}

lab <- c(disagree=1, neutral=2, agree=3)

```


Add value labels to Var2 and Var3

```{r}

d3 <- d3 %>% labelled::set_value_labels(Var2=lab, Var3=lab)

d3 %>% labelled::val_labels()

```

---

#### Function: `add_value_labels()`

---

**1\. Update or add one or more value labels to a variable (Var3) without replacing/removing the other value labels**

Review the data (d3)

```{r, echo=FALSE}

source("data.R")
d3

```

View current labels for Var3

```{r, echo=FALSE}

d3 <- d3 %>% labelled::set_value_labels(
  Var3=c("none"=1, "reduced-price"=2, "free"=3))

d3 %>% labelled::val_labels()

```

Update the label for `1` in Var3

* Note: Parentheses are *not* required around labels here, although adding them will not hurt.

```{r}

d3 <- d3 %>% labelled::add_value_labels(Var3=c(paid=1))

d3 %>% labelled::val_labels()

```

---

#### Function: `labelled()`

---

**1\. Add the same value labels to multiple variables with similar names (Var1, Var2, and Var3)**

Review the data (d3)

```{r, echo=FALSE}

source("data.R")
d3

```

Add value labels to multiple variables with similar names by adding the selection helper `starts_with()`.

* Note: Other `tidyselect` selection helpers include `ends_with()`, `contains()`, `matches()`, and `num_range()`, `where()` and more.

* Note: Also note the addition of `dplyr::mutate_at()` to create new variables with these new labels (the overwrite the current variables). This function is needed in order to utilize the `starts_with()` selection helper.

* Note: Parentheses are *not* required around labels here, although adding them will not hurt.

```{r}

d3 <- d3 %>% 
  dplyr::mutate_at(vars(tidyselect::starts_with('Var')), 
            ~labelled::labelled(., labels = c(disagree=1, neutral=2, agree=3)))

d3 %>% labelled::val_labels()

```
